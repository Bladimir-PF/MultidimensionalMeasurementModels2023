<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Subscores and Popular Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="14_Subscores_and_Popular_Models_files/libs/clipboard/clipboard.min.js"></script>
<script src="14_Subscores_and_Popular_Models_files/libs/quarto-html/quarto.js"></script>
<script src="14_Subscores_and_Popular_Models_files/libs/quarto-html/popper.min.js"></script>
<script src="14_Subscores_and_Popular_Models_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="14_Subscores_and_Popular_Models_files/libs/quarto-html/anchor.min.js"></script>
<link href="14_Subscores_and_Popular_Models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="14_Subscores_and_Popular_Models_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="14_Subscores_and_Popular_Models_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="14_Subscores_and_Popular_Models_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="14_Subscores_and_Popular_Models_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script>
window.MathJax = {
  loader: {
    load: ['[tex]/upgreek', '[tex]/boldsymbol', '[tex]/physics']
  },
  tex: {
    packages: {
      '[+]': ['upgreek', 'boldsymbol', 'physics']
    }
  }
};
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Subscores and Popular Models</h1>
<p class="subtitle lead">Multidimensional Measurement Models (Fall 2023): Lecture 14</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="todays-lecture" class="level2">
<h2 class="anchored" data-anchor-id="todays-lecture">Today’s Lecture</h2>
<ul>
<li>The Educational Measurement Problem: Total vs.&nbsp;Subscores
<ul>
<li>The problem with subscores when having a unidimensional total score</li>
<li>The problem with a unidimensional total score when having a multidimensional assessment</li>
</ul></li>
<li>Bifactor IRT Models</li>
<li>Higher Order IRT Models</li>
<li>Historical issues with Bifactor and Higher Order Models</li>
</ul>
</section>
<section id="key-definition-subscore" class="level2">
<h2 class="anchored" data-anchor-id="key-definition-subscore">Key Definition: Subscore</h2>
<p>A subscore is a score that is formed by taking some items of an assessment</p>
<ul>
<li><p>For instance, consider an algebra test measuring four algebra standards:</p>
<ul>
<li>The total score (measuring algebra) is formed using all the items
<ul>
<li>Note: “formed” is intentionally ambiguous and can mean summing all items (a parallel items model) or estimating a latent variable score using scoring methods from IRT</li>
</ul></li>
<li>A subscore for each standard can be formed using only the items measuring that standard</li>
</ul></li>
</ul>
</section>
<section id="the-educational-measurement-problem-total-vs.-subscores" class="level2">
<h2 class="anchored" data-anchor-id="the-educational-measurement-problem-total-vs.-subscores">The Educational Measurement Problem: Total vs.&nbsp;Subscores</h2>
<p>The issue (from K-12 assessment):</p>
<ul>
<li>Assessment programs are designed to provide a single score for each student for each subject (e.g., reading, math, science, etc.)</li>
<li>However, many states also wish to provide more detailed information to each student
<ul>
<li>“Subscores” are often used to provide more detailed information about a student’s performance</li>
</ul></li>
<li>A subscore is a score that is based on a subset of the items on a test
<ul>
<li>For example, a reading test may have a subscore for “vocabulary” and a subscore for “reading comprehension”</li>
<li>A math test may have a subscore for “algebra” and a subscore for “geometry”</li>
</ul></li>
</ul>
<section id="the-problem-with-subscores-when-having-a-unidimensional-total-score" class="level3">
<h3 class="anchored" data-anchor-id="the-problem-with-subscores-when-having-a-unidimensional-total-score">The problem with subscores when having a unidimensional total score</h3>
<ul>
<li>The basic problem is a modeling problem:
<ul>
<li>The total score has a unidimensional model</li>
<li>The subscores have a multidimensional model</li>
<li>The two models are incompatible and cannot both be correct</li>
</ul></li>
</ul>
</section>
<section id="unidimensional-model" class="level3">
<h3 class="anchored" data-anchor-id="unidimensional-model">Unidimensional Model</h3>
<p>The model for the total score is often a unidimensional model:</p>
<p><span class="math display">\[
P(Y_{pi} = 1 | \theta_p) =
  \frac{\exp \left(a_i \left( \theta_p - b_i \right) \right)}
  {1 + \exp \left(a_i \left( \theta_p - b_i \right) \right)}
\]</span></p>
<p>This model applies for all items <span class="math inline">\(i\)</span> and all persons <span class="math inline">\(p\)</span></p>
<p>Note: The model shown is a two-parameter IRT model, but in general, there will be one latent variable in a unidimensional model</p>
<div class="cell" data-layout-align="center" data-hash="14_Subscores_and_Popular_Models_cache/html/unidim_1bcfc453811b2b05b25a5ffd1ac097ce">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># format data </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>responseMatrix <span class="ot">=</span> temp<span class="sc">$</span>responseMatrix</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Qmatrix <span class="ot">=</span> temp<span class="sc">$</span>Qmatrix</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>reducedQ <span class="ot">=</span> Qmatrix[<span class="fu">which</span>(<span class="fu">rownames</span>(Qmatrix) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>)), ]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>reducedQ <span class="ot">=</span> reducedQ[, <span class="fu">which</span>(<span class="fu">colSums</span>(reducedQ) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># using only Algebra items (11:30) ====================================================================================</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>dataMat <span class="ot">=</span> responseMatrix[<span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>)]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># remove cases that are all NA ========================================================================================</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>dataMat <span class="ot">=</span> dataMat[<span class="fu">apply</span>(dataMat, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.na</span>(x))), ]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create lavaan model for unidimensional model ========================================================================</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(responseMatrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "item1"           "item2"           "item3"           "item4"          
 [5] "item5"           "item6"           "item7"           "item8"          
 [9] "item9"           "item10"          "item11"          "item12"         
[13] "item13"          "item14"          "item15"          "item16"         
[17] "item17"          "item18"          "item19"          "item20"         
[21] "item21"          "item22"          "item23"          "item24"         
[25] "item25"          "item26"          "item27"          "item28"         
[29] "item29"          "item30"          "item31"          "item32"         
[33] "item33"          "item34"          "item35"          "item36"         
[37] "item37"          "item38"          "item39"          "item40"         
[41] "item41"          "item42"          "item43"          "item44"         
[45] "item45"          "item46"          "item47"          "item48"         
[49] "item49"          "item50"          "courseNameCombo" "id"             </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>unidimensionalModel_syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">theta =~ item11 + item12 + item13 + item14 + item15 + </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">         item16 + item17 + item18 + item19 + item20 + </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">         item21 + item22 + item23 + item24 + item25 + </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">         item26 + item27 + item28 + item29 + item30</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>unidimensionalModel <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> unidimensionalModel_syntax, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> responseMatrix, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"WLSMV"</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>), </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameterization =</span> <span class="st">"theta"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(unidimensionalModel, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 15 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        40

                                                  Used       Total
  Number of observations                          1099        2541

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               419.002     514.212
  Degrees of freedom                               170         170
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.847
  Shift parameter                                           19.655
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                              5341.853    3322.839
  Degrees of freedom                               190         190
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.644

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.952       0.890
  Tucker-Lewis Index (TLI)                       0.946       0.877
                                                                  
  Robust Comparative Fit Index (CFI)                         0.799
  Robust Tucker-Lewis Index (TLI)                            0.775

Root Mean Square Error of Approximation:

  RMSEA                                          0.037       0.043
  90 Percent confidence interval - lower         0.032       0.039
  90 Percent confidence interval - upper         0.041       0.047
  P-value H_0: RMSEA &lt;= 0.050                    1.000       0.997
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.073
  90 Percent confidence interval - lower                     0.065
  90 Percent confidence interval - upper                     0.080
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.061

Standardized Root Mean Square Residual:

  SRMR                                           0.066       0.066

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  theta =~                                                              
    item11            0.864    0.074   11.634    0.000    0.864    0.654
    item12            0.286    0.053    5.421    0.000    0.286    0.275
    item13            0.768    0.062   12.382    0.000    0.768    0.609
    item14            0.589    0.053   11.017    0.000    0.589    0.508
    item15            0.474    0.049    9.626    0.000    0.474    0.428
    item16            0.703    0.055   12.835    0.000    0.703    0.575
    item17            0.710    0.056   12.576    0.000    0.710    0.579
    item18            0.867    0.066   13.192    0.000    0.867    0.655
    item19            0.912    0.067   13.547    0.000    0.912    0.674
    item20            0.820    0.078   10.577    0.000    0.820    0.634
    item21            0.173    0.045    3.799    0.000    0.173    0.170
    item22            0.310    0.057    5.441    0.000    0.310    0.296
    item23            0.437    0.056    7.736    0.000    0.437    0.400
    item24            0.374    0.052    7.164    0.000    0.374    0.350
    item25            0.433    0.053    8.129    0.000    0.433    0.398
    item26            0.569    0.062    9.150    0.000    0.569    0.494
    item27            0.422    0.048    8.785    0.000    0.422    0.389
    item28            0.605    0.057   10.706    0.000    0.605    0.518
    item29            0.257    0.058    4.411    0.000    0.257    0.249
    item30            0.390    0.053    7.292    0.000    0.390    0.363

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            0.000                               0.000    0.000
   .item12            0.000                               0.000    0.000
   .item13            0.000                               0.000    0.000
   .item14            0.000                               0.000    0.000
   .item15            0.000                               0.000    0.000
   .item16            0.000                               0.000    0.000
   .item17            0.000                               0.000    0.000
   .item18            0.000                               0.000    0.000
   .item19            0.000                               0.000    0.000
   .item20            0.000                               0.000    0.000
   .item21            0.000                               0.000    0.000
   .item22            0.000                               0.000    0.000
   .item23            0.000                               0.000    0.000
   .item24            0.000                               0.000    0.000
   .item25            0.000                               0.000    0.000
   .item26            0.000                               0.000    0.000
   .item27            0.000                               0.000    0.000
   .item28            0.000                               0.000    0.000
   .item29            0.000                               0.000    0.000
   .item30            0.000                               0.000    0.000
    theta             0.000                               0.000    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11|t1         0.460    0.055    8.384    0.000    0.460    0.348
    item12|t1         0.645    0.043   14.979    0.000    0.645    0.620
    item13|t1         0.128    0.048    2.654    0.008    0.128    0.102
    item14|t1         0.131    0.044    2.966    0.003    0.131    0.113
    item15|t1         0.082    0.042    1.955    0.051    0.082    0.074
    item16|t1        -0.141    0.046   -3.060    0.002   -0.141   -0.115
    item17|t1        -0.038    0.046   -0.815    0.415   -0.038   -0.031
    item18|t1        -0.044    0.050   -0.877    0.381   -0.044   -0.033
    item19|t1        -0.113    0.051   -2.214    0.027   -0.113   -0.083
    item20|t1         0.610    0.057   10.675    0.000    0.610    0.472
    item21|t1         0.266    0.039    6.824    0.000    0.266    0.262
    item22|t1         0.824    0.046   17.874    0.000    0.824    0.787
    item23|t1         0.623    0.046   13.661    0.000    0.623    0.571
    item24|t1         0.512    0.043   11.893    0.000    0.512    0.480
    item25|t1         0.484    0.044   11.049    0.000    0.484    0.444
    item26|t1         0.618    0.049   12.572    0.000    0.618    0.537
    item27|t1         0.170    0.041    4.109    0.000    0.170    0.157
    item28|t1         0.345    0.046    7.485    0.000    0.345    0.295
    item29|t1         0.781    0.045   17.458    0.000    0.781    0.756
    item30|t1         0.551    0.044   12.571    0.000    0.551    0.513

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            1.000                               1.000    0.572
   .item12            1.000                               1.000    0.925
   .item13            1.000                               1.000    0.629
   .item14            1.000                               1.000    0.742
   .item15            1.000                               1.000    0.817
   .item16            1.000                               1.000    0.669
   .item17            1.000                               1.000    0.665
   .item18            1.000                               1.000    0.571
   .item19            1.000                               1.000    0.546
   .item20            1.000                               1.000    0.598
   .item21            1.000                               1.000    0.971
   .item22            1.000                               1.000    0.912
   .item23            1.000                               1.000    0.840
   .item24            1.000                               1.000    0.877
   .item25            1.000                               1.000    0.842
   .item26            1.000                               1.000    0.755
   .item27            1.000                               1.000    0.849
   .item28            1.000                               1.000    0.732
   .item29            1.000                               1.000    0.938
   .item30            1.000                               1.000    0.868
    theta             1.000                               1.000    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11            0.757                               0.757    1.000
    item12            0.962                               0.962    1.000
    item13            0.793                               0.793    1.000
    item14            0.862                               0.862    1.000
    item15            0.904                               0.904    1.000
    item16            0.818                               0.818    1.000
    item17            0.816                               0.816    1.000
    item18            0.756                               0.756    1.000
    item19            0.739                               0.739    1.000
    item20            0.773                               0.773    1.000
    item21            0.985                               0.985    1.000
    item22            0.955                               0.955    1.000
    item23            0.916                               0.916    1.000
    item24            0.937                               0.937    1.000
    item25            0.918                               0.918    1.000
    item26            0.869                               0.869    1.000
    item27            0.921                               0.921    1.000
    item28            0.856                               0.856    1.000
    item29            0.969                               0.969    1.000
    item30            0.932                               0.932    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>unidimensionalScores <span class="ot">=</span> <span class="fu">lavPredict</span>(unidimensionalModel)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(unidimensionalModel, <span class="at">sizeMan =</span> <span class="fl">2.5</span>, <span class="at">style =</span> <span class="st">"mx"</span>, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">thresholds =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unidim-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="unidimensional-model-path-diagram" class="level3">
<h3 class="anchored" data-anchor-id="unidimensional-model-path-diagram">Unidimensional Model Path Diagram</h3>
<div class="cell" data-layout-align="center" data-hash="14_Subscores_and_Popular_Models_cache/html/plotUnidimensionalModel_e2ceab2d1a045fb173f00e3a9e8dd3d4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(unidimensionalModel, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sizeMan =</span> <span class="fl">2.5</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">style =</span> <span class="st">"mx"</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercepts =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">thresholds =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/plotUnidimensionalModel-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="common-subscore-estimation-methods" class="level3">
<h3 class="anchored" data-anchor-id="common-subscore-estimation-methods">Common Subscore Estimation Methods</h3>
<p>With an overall score from the unidimensional model, often subscores are formed by one of the following methods:</p>
<ol type="1">
<li><p>Using the unidimensional model parameters to create IRT-based subscores where:</p>
<ul>
<li>Each score is a latent variable estimate from the IRT model</li>
<li>Each estimate is with respect to only the set of items that contribute/measure the subdomains</li>
</ul></li>
<li><p>Summing items that measure the subdomains (here, the standards)</p>
<ul>
<li>Lecture 13 showed this was a parallel items model</li>
</ul></li>
</ol>
<p>Each of these methods has problems (to be discussed)</p>
</section>
<section id="unidimensional-irt-model-based-subscores" class="level3">
<h3 class="anchored" data-anchor-id="unidimensional-irt-model-based-subscores">Unidimensional IRT-Model Based Subscores</h3>
<p>Unidimensional IRT-Model Subscores are created by:</p>
<ul>
<li>Taking the estimated parameters of only the items measuring a subdomain</li>
<li>Using IRT-based scoring methods</li>
</ul>
<p>Note: As I am using <code>lavaan</code> for this lecture, I cannot easily create these scores</p>
<ul>
<li>Instead: Showing a simulation with the <code>mirt</code> package
<ul>
<li>See file <code>subscoreSame.R</code> for methods for constructing scores</li>
</ul></li>
</ul>
</section>
<section id="unidimensional-irt-model-based-subscores-are-just-short-form-scores-of-the-same-construct" class="level3">
<h3 class="anchored" data-anchor-id="unidimensional-irt-model-based-subscores-are-just-short-form-scores-of-the-same-construct">Unidimensional IRT-Model Based Subscores Are Just Short-Form Scores of the Same Construct</h3>
<p><img src="subscoreSame.png" class="img-fluid"></p>
</section>
<section id="sum-score-based-subscores" class="level3">
<h3 class="anchored" data-anchor-id="sum-score-based-subscores">Sum-score Based Subscores</h3>
<p>Sum-score based subscores are estimated by summing the items that measure each subdomain</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>reducedQ <span class="ot">=</span> Qmatrix[<span class="fu">which</span>(<span class="fu">rownames</span>(Qmatrix) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>)), ]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>reducedQ <span class="ot">=</span> reducedQ[, <span class="fu">which</span>(<span class="fu">colSums</span>(reducedQ) <span class="sc">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>sumScores <span class="ot">=</span> <span class="fu">as.matrix</span>(dataMat) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(reducedQ)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># problem with sumscores: missing data </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sumScores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A.REI.1 A.REI.2 A.REI.8 A.CED.2
1        2       5       0       1
2        3       0       0       1
4        2       1       1       2
7        1       2       1       0
9        4       1       2       0
11       3       4       4       4</code></pre>
</div>
</div>
</section>
<section id="sum-score-based-subscores-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="sum-score-based-subscores-missing-data">Sum-score Based Subscores: Missing Data</h3>
<p>One problem with sum-score based subscores is missing data</p>
<ul>
<li>If a person omits a response, their total score possible is lower</li>
</ul>
<p>Solution: Mean-based Subscores (the mean of all items administered)</p>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/avgscores_ac88ea0f4cc025b9d57678fc6b59169e">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># resolution: make an average score for each student</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>averageScores <span class="ot">=</span> nItems <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(sumScores), <span class="at">ncol =</span> <span class="fu">ncol</span>(sumScores))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (person <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dataMat)){</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(reducedQ)){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(reducedQ)){</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (reducedQ[row, col] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dataMat[person, row])){</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        averageScores[person, col] <span class="ot">=</span> averageScores[person, col] <span class="sc">+</span> dataMat[person, row]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        nItems[person, col] <span class="ot">=</span> nItems[person, col] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>      }   </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    averageScores[person, col] <span class="ot">=</span> averageScores[person, col] <span class="sc">/</span> nItems[person, col]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(averageScores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]  0.4  1.0  0.0  0.2
[2,]  0.6  0.0  0.0  0.2
[3,]  0.4  0.2  0.2  0.4
[4,]  0.2  0.4  0.2  0.0
[5,]  0.8  0.2  0.4  0.0
[6,]  0.6  0.8  0.8  0.8</code></pre>
</div>
</div>
</section>
<section id="plots-of-subscores-vs.-overall-score" class="level3">
<h3 class="anchored" data-anchor-id="plots-of-subscores-vs.-overall-score">Plots of Subscores vs.&nbsp;Overall Score</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/sumscorePlot_26f88760de1a0123440d251de42008e2">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting scores:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (standard <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(reducedQ)){</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> sumScores[,standard], <span class="at">y =</span> unidimensionalScores, <span class="at">main =</span> <span class="st">"Sum Scores vs. Unidimensional Scores"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">"IRT Total Theta"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">paste0</span>(<span class="st">"Sum Score "</span>, <span class="fu">colnames</span>(reducedQ)[standard]))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/sumscorePlot-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="measurement-model-implied-by-sumscore-based-subscores" class="level3">
<h3 class="anchored" data-anchor-id="measurement-model-implied-by-sumscore-based-subscores">Measurement Model Implied by Sumscore-based Subscores</h3>
<p>The measurement model implied by sumscore-based subscores is a multidimensional CFA model where:</p>
<ul>
<li>Each item intercept, loading, and unique variance are constrained to be equal across subdomains</li>
<li>The correlation between factors is fixed to zero</li>
</ul>
<p>Subscore 1: <span class="math display">\[
\begin{array}{c}
Y_{p1} = \mu_1 + \lambda_1 F_{p1} + e_{p1}; e_{p1} \sim N(0, \psi^2_1) \\
Y_{p2} = \mu_2 + \lambda_1 F_{p1} + e_{p2}; e_{p2} \sim N(0, \psi^2_1) \\
\vdots \\
Y_{p5} = \mu_5 + \lambda_1 F_{p1} + e_{p5}; e_{p5} \sim N(0, \psi^2_1)
\end{array}
\]</span></p>
<p>Subscore 2: <span class="math display">\[
\begin{array}{c}
Y_{p6} = \mu_6 + \lambda_2 F_{p2} + e_{p6}; e_{p6} \sim N(0, \psi^2_2) \\
Y_{p7} = \mu_7 + \lambda_2 F_{p2} + e_{p7}; e_{p7} \sim N(0, \psi^2_2) \\
\vdots \\
Y_{p10} = \mu_10 + \lambda_2 F_{p2} + e_{p10}; e_{p10} \sim N(0, \psi^2_2)
\end{array}
\]</span></p>
<p>Structural model:</p>
<p><span class="math display">\[
\begin{bmatrix}
\theta_{p1} \\
\theta_{p2} \\
\theta_{p3} \\
\theta_{p4} \\
\end{bmatrix}
\sim N \left(\boldsymbol{0}, \boldsymbol{I}_{4} \right)
\]</span></p>
</section>
<section id="implementing-sumscore-based-subscore-model-in-lavaan" class="level3">
<h3 class="anchored" data-anchor-id="implementing-sumscore-based-subscore-model-in-lavaan">Implementing Sumscore-Based Subscore Model in <code>lavaan</code></h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-3_cd21cb570e80ffb5c7531a140c8fc756">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>parallelItems_syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st"># constrain all loadings to be equal within each subscore</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 =~ L1*item11 + L1*item12 + L1*item13 + L1*item14 + L1*item15</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">theta2 =~ L2*item16 + L2*item17 + L2*item18 + L2*item19 + L2*item20</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">theta3 =~ L3*item21 + L3*item22 + L3*item23 + L3*item24 + L3*item25</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">theta4 =~ L4*item26 + L4*item27 + L4*item28 + L4*item29 + L4*item30</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st"># set the unique variances to be equal within each subscore</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">item11 ~~ U1*item11; item12 ~~ U1*item12; item13 ~~ U1*item13; item14 ~~ U1*item14; item15 ~~ U1*item15;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="st">item16 ~~ U2*item16; item17 ~~ U2*item17; item18 ~~ U2*item18; item19 ~~ U2*item19; item20 ~~ U2*item20;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="st">item21 ~~ U3*item21; item22 ~~ U3*item22; item23 ~~ U3*item23; item24 ~~ U3*item24; item25 ~~ U3*item25;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="st">item26 ~~ U4*item26; item27 ~~ U4*item27; item28 ~~ U4*item28; item29 ~~ U4*item29; item30 ~~ U4*item30;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="st"># set all covariances to zero</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 ~~ 0*theta2</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 ~~ 0*theta3</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 ~~ 0*theta4</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="st">theta2 ~~ 0*theta3</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="st">theta2 ~~ 0*theta4</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">theta3 ~~ 0*theta4</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>parallelItemsModel <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> parallelItems_syntax, </span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dataMat, </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>,</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(parallelItemsModel, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 17 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        40
  Number of equality constraints                    32

  Number of observations                          1099

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                              1189.531    1236.996
  Degrees of freedom                               202         202
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.962
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              2354.623    2286.856
  Degrees of freedom                               190         190
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.030

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.544       0.506
  Tucker-Lewis Index (TLI)                       0.571       0.536
                                                                  
  Robust Comparative Fit Index (CFI)                         0.539
  Robust Tucker-Lewis Index (TLI)                            0.566

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -14167.940  -14167.940
  Scaling correction factor                                  0.158
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)     -13573.174  -13573.174
  Scaling correction factor                                  0.955
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                               28351.879   28351.879
  Bayesian (BIC)                             28391.896   28391.896
  Sample-size adjusted Bayesian (SABIC)      28366.487   28366.487

Root Mean Square Error of Approximation:

  RMSEA                                          0.067       0.068
  90 Percent confidence interval - lower         0.063       0.065
  90 Percent confidence interval - upper         0.070       0.072
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.067
  90 Percent confidence interval - lower                     0.063
  90 Percent confidence interval - upper                     0.071
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.119       0.119

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  theta1 =~                                                             
    item11    (L1)    0.207    0.008   25.443    0.000    0.207    0.428
    item12    (L1)    0.207    0.008   25.443    0.000    0.207    0.428
    item13    (L1)    0.207    0.008   25.443    0.000    0.207    0.428
    item14    (L1)    0.207    0.008   25.443    0.000    0.207    0.428
    item15    (L1)    0.207    0.008   25.443    0.000    0.207    0.428
  theta2 =~                                                             
    item16    (L2)    0.267    0.007   39.947    0.000    0.267    0.542
    item17    (L2)    0.267    0.007   39.947    0.000    0.267    0.542
    item18    (L2)    0.267    0.007   39.947    0.000    0.267    0.542
    item19    (L2)    0.267    0.007   39.947    0.000    0.267    0.542
    item20    (L2)    0.267    0.007   39.947    0.000    0.267    0.542
  theta3 =~                                                             
    item21    (L3)    0.151    0.010   14.505    0.000    0.151    0.330
    item22    (L3)    0.151    0.010   14.505    0.000    0.151    0.330
    item23    (L3)    0.151    0.010   14.505    0.000    0.151    0.330
    item24    (L3)    0.151    0.010   14.505    0.000    0.151    0.330
    item25    (L3)    0.151    0.010   14.505    0.000    0.151    0.330
  theta4 =~                                                             
    item26    (L4)    0.180    0.009   19.182    0.000    0.180    0.389
    item27    (L4)    0.180    0.009   19.182    0.000    0.180    0.389
    item28    (L4)    0.180    0.009   19.182    0.000    0.180    0.389
    item29    (L4)    0.180    0.009   19.182    0.000    0.180    0.389
    item30    (L4)    0.180    0.009   19.182    0.000    0.180    0.389

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  theta1 ~~                                                             
    theta2            0.000                               0.000    0.000
    theta3            0.000                               0.000    0.000
    theta4            0.000                               0.000    0.000
  theta2 ~~                                                             
    theta3            0.000                               0.000    0.000
    theta4            0.000                               0.000    0.000
  theta3 ~~                                                             
    theta4            0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11    (U1)    0.192    0.003   56.690    0.000    0.192    0.817
   .item12    (U1)    0.192    0.003   56.690    0.000    0.192    0.817
   .item13    (U1)    0.192    0.003   56.690    0.000    0.192    0.817
   .item14    (U1)    0.192    0.003   56.690    0.000    0.192    0.817
   .item15    (U1)    0.192    0.003   56.690    0.000    0.192    0.817
   .item16    (U2)    0.171    0.003   49.772    0.000    0.171    0.706
   .item17    (U2)    0.171    0.003   49.772    0.000    0.171    0.706
   .item18    (U2)    0.171    0.003   49.772    0.000    0.171    0.706
   .item19    (U2)    0.171    0.003   49.772    0.000    0.171    0.706
   .item20    (U2)    0.171    0.003   49.772    0.000    0.171    0.706
   .item21    (U3)    0.187    0.003   55.545    0.000    0.187    0.891
   .item22    (U3)    0.187    0.003   55.545    0.000    0.187    0.891
   .item23    (U3)    0.187    0.003   55.545    0.000    0.187    0.891
   .item24    (U3)    0.187    0.003   55.545    0.000    0.187    0.891
   .item25    (U3)    0.187    0.003   55.545    0.000    0.187    0.891
   .item26    (U4)    0.183    0.003   53.285    0.000    0.183    0.849
   .item27    (U4)    0.183    0.003   53.285    0.000    0.183    0.849
   .item28    (U4)    0.183    0.003   53.285    0.000    0.183    0.849
   .item29    (U4)    0.183    0.003   53.285    0.000    0.183    0.849
   .item30    (U4)    0.183    0.003   53.285    0.000    0.183    0.849
    theta1            1.000                               1.000    1.000
    theta2            1.000                               1.000    1.000
    theta3            1.000                               1.000    1.000
    theta4            1.000                               1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="plotting-sumscores-vs.-latent-variable-scores" class="level3">
<h3 class="anchored" data-anchor-id="plotting-sumscores-vs.-latent-variable-scores">Plotting Sumscores vs.&nbsp;Latent Variable Scores</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-4_0af615b444a962e5bf62fed971cdede8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create latent variable estimates</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>parallelItemsScores <span class="ot">=</span> <span class="fu">lavPredict</span>(parallelItemsModel)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting model scores with sumscores</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (standard <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(reducedQ)){</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">x =</span> parallelItemsScores[, standard],  <span class="at">y =</span> sumScores[, standard], </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Parallel Items Model Score vs. Sum Score"</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="fu">paste0</span>(<span class="st">"Parallel Items Model Score: "</span>, <span class="fu">colnames</span>(reducedQ)[standard]), </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">"Sum Score: "</span>, <span class="fu">colnames</span>(reducedQ)[standard])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-better-measurement-model-implied-by-subscores" class="level3">
<h3 class="anchored" data-anchor-id="a-better-measurement-model-implied-by-subscores">A Better Measurement Model Implied by Subscores</h3>
<p>Contrast the unidimensional model with that assumed by the subscores: the multidimensional model</p>
<p>Standards measured (and measurement model):</p>
<ul>
<li>A.REI.1 (<span class="math inline">\(\theta_{p1}\)</span>)</li>
</ul>
<p><span class="math display">\[P(Y_{pi} = 1 | \theta_{p1}) =
\frac{\exp \left(a_i \left( \theta_{p1} - b_i \right) \right)}{1 + \exp \left(a_i \left( \theta_{p1} - b_i \right) \right)} \]</span></p>
<ul>
<li>A.REI.2 (<span class="math inline">\(\theta_{p2}\)</span>)</li>
</ul>
<p><span class="math display">\[P(Y_{pi} = 1 | \theta_{p2}) = \frac{\exp \left(a_i \left( \theta_{p2} - b_i \right) \right)}{1 + \exp \left(a_i \left( \theta_{p2} - b_i \right) \right)} \]</span></p>
<ul>
<li>A.REI.8 (<span class="math inline">\(\theta_{p3}\)</span>)</li>
</ul>
<p><span class="math display">\[P(Y_{pi} = 1 | \theta_{p3}) = \frac{\exp \left(a_i \left( \theta_{p3} - b_i \right) \right)}{1 + \exp \left(a_i \left( \theta_{p3} - b_i \right) \right)} \]</span></p>
<ul>
<li>A.CED.2 (<span class="math inline">\(\theta_{p4}\)</span>)</li>
</ul>
<p><span class="math display">\[P(Y_{pi} = 1 | \theta_{p4}) = \frac{\exp \left(a_i \left( \theta_{p4} - b_i \right) \right)}{1 + \exp \left(a_i \left( \theta_{p4} - b_i \right) \right)} \]</span></p>
</section>
<section id="structural-model-implied-by-subscores" class="level3">
<h3 class="anchored" data-anchor-id="structural-model-implied-by-subscores">Structural Model Implied by Subscores</h3>
<p><span class="math display">\[
\begin{bmatrix}
\theta_{p1} \\
\theta_{p2} \\
\theta_{p3} \\
\theta_{p4} \\
\end{bmatrix}
\sim N \left(\boldsymbol{0}, \boldsymbol{\Sigma}_{M} \right)
\]</span></p>
<p>Where:</p>
<p><span class="math display">\[
\mathbf{\Sigma}_{M} =
\begin{bmatrix}
1 &amp; \rho_{\theta_1, \theta_2} &amp; \rho_{\theta_1, \theta_3} &amp; \rho_{\theta_1, \theta_4} \\
\rho_{\theta_1, \theta_2} &amp; 1 &amp; \rho_{\theta_2, \theta_3} &amp; \rho_{\theta_2, \theta_4} \\
\rho_{\theta_1, \theta_3} &amp; \rho_{\theta_2, \theta_3} &amp; 1 &amp; \rho_{\theta_3, \theta_4} \\
\rho_{\theta_1, \theta_4} &amp; \rho_{\theta_2, \theta_4} &amp; \rho_{\theta_3, \theta_4} &amp; 1 \\
\end{bmatrix}
\]</span></p>
<p>Here, <span class="math inline">\(\mathbf{\Sigma}_{M}\)</span> is a correlation matrix implying identification via standardized factors</p>
<div class="cell" data-layout-align="center" data-hash="14_Subscores_and_Popular_Models_cache/html/multidimensionalModel_86d981a7cd402f735273719fd78a52a2">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>multidimensionalModel_syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 =~ item11 + item12 + item13 + item14 + item15</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="st">theta2 =~ item16 + item17 + item18 + item19 + item20</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="st">theta3 =~ item21 + item22 + item23 + item24 + item25</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="st">theta4 =~ item26 + item27 + item28 + item29 + item30</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>multidimensionalModel <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> multidimensionalModel_syntax, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> responseMatrix, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"WLSMV"</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>), </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameterization =</span> <span class="st">"theta"</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multidimensionalModel, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 26 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        46

                                                  Used       Total
  Number of observations                          1099        2541

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               233.931     298.881
  Degrees of freedom                               164         164
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.832
  Shift parameter                                           17.797
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                              5341.853    3322.839
  Degrees of freedom                               190         190
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.644

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.986       0.957
  Tucker-Lewis Index (TLI)                       0.984       0.950
                                                                  
  Robust Comparative Fit Index (CFI)                         0.916
  Robust Tucker-Lewis Index (TLI)                            0.903

Root Mean Square Error of Approximation:

  RMSEA                                          0.020       0.027
  90 Percent confidence interval - lower         0.014       0.022
  90 Percent confidence interval - upper         0.025       0.032
  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.048
  90 Percent confidence interval - lower                     0.038
  90 Percent confidence interval - upper                     0.057
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.642
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.051       0.051

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  theta1 =~                                                             
    item11            1.060    0.109    9.769    0.000    1.060    0.727
    item12            0.307    0.057    5.362    0.000    0.307    0.294
    item13            0.914    0.083   10.988    0.000    0.914    0.675
    item14            0.678    0.065   10.470    0.000    0.678    0.561
    item15            0.531    0.056    9.410    0.000    0.531    0.469
  theta2 =~                                                             
    item16            0.808    0.067   12.124    0.000    0.808    0.629
    item17            0.809    0.069   11.760    0.000    0.809    0.629
    item18            1.005    0.086   11.670    0.000    1.005    0.709
    item19            1.072    0.090   11.864    0.000    1.072    0.731
    item20            0.919    0.098    9.397    0.000    0.919    0.677
  theta3 =~                                                             
    item21            0.227    0.058    3.920    0.000    0.227    0.221
    item22            0.419    0.078    5.408    0.000    0.419    0.387
    item23            0.679    0.093    7.333    0.000    0.679    0.562
    item24            0.593    0.079    7.537    0.000    0.593    0.510
    item25            0.680    0.088    7.758    0.000    0.680    0.562
  theta4 =~                                                             
    item26            0.764    0.094    8.152    0.000    0.764    0.607
    item27            0.565    0.062    9.161    0.000    0.565    0.492
    item28            0.857    0.089    9.609    0.000    0.857    0.651
    item29            0.325    0.070    4.665    0.000    0.325    0.309
    item30            0.498    0.067    7.434    0.000    0.498    0.446

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  theta1 ~~                                                             
    theta2            0.754    0.036   20.945    0.000    0.754    0.754
    theta3            0.522    0.056    9.336    0.000    0.522    0.522
    theta4            0.765    0.044   17.284    0.000    0.765    0.765
  theta2 ~~                                                             
    theta3            0.624    0.047   13.315    0.000    0.624    0.624
    theta4            0.583    0.045   12.964    0.000    0.583    0.583
  theta3 ~~                                                             
    theta4            0.542    0.066    8.179    0.000    0.542    0.542

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            0.000                               0.000    0.000
   .item12            0.000                               0.000    0.000
   .item13            0.000                               0.000    0.000
   .item14            0.000                               0.000    0.000
   .item15            0.000                               0.000    0.000
   .item16            0.000                               0.000    0.000
   .item17            0.000                               0.000    0.000
   .item18            0.000                               0.000    0.000
   .item19            0.000                               0.000    0.000
   .item20            0.000                               0.000    0.000
   .item21            0.000                               0.000    0.000
   .item22            0.000                               0.000    0.000
   .item23            0.000                               0.000    0.000
   .item24            0.000                               0.000    0.000
   .item25            0.000                               0.000    0.000
   .item26            0.000                               0.000    0.000
   .item27            0.000                               0.000    0.000
   .item28            0.000                               0.000    0.000
   .item29            0.000                               0.000    0.000
   .item30            0.000                               0.000    0.000
    theta1            0.000                               0.000    0.000
    theta2            0.000                               0.000    0.000
    theta3            0.000                               0.000    0.000
    theta4            0.000                               0.000    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11|t1         0.507    0.065    7.814    0.000    0.507    0.348
    item12|t1         0.649    0.044   14.888    0.000    0.649    0.620
    item13|t1         0.138    0.052    2.639    0.008    0.138    0.102
    item14|t1         0.137    0.046    2.956    0.003    0.137    0.113
    item15|t1         0.084    0.043    1.954    0.051    0.084    0.074
    item16|t1        -0.148    0.049   -3.060    0.002   -0.148   -0.115
    item17|t1        -0.040    0.049   -0.816    0.415   -0.040   -0.031
    item18|t1        -0.047    0.053   -0.877    0.381   -0.047   -0.033
    item19|t1        -0.122    0.055   -2.215    0.027   -0.122   -0.083
    item20|t1         0.641    0.063   10.109    0.000    0.641    0.472
    item21|t1         0.268    0.040    6.797    0.000    0.268    0.262
    item22|t1         0.853    0.052   16.444    0.000    0.853    0.787
    item23|t1         0.690    0.059   11.726    0.000    0.690    0.571
    item24|t1         0.558    0.051   10.915    0.000    0.558    0.480
    item25|t1         0.537    0.054    9.898    0.000    0.537    0.444
    item26|t1         0.676    0.061   11.023    0.000    0.676    0.537
    item27|t1         0.180    0.044    4.071    0.000    0.180    0.157
    item28|t1         0.389    0.056    7.001    0.000    0.389    0.295
    item29|t1         0.795    0.047   16.808    0.000    0.795    0.756
    item30|t1         0.573    0.047   12.089    0.000    0.573    0.513

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            1.000                               1.000    0.471
   .item12            1.000                               1.000    0.914
   .item13            1.000                               1.000    0.545
   .item14            1.000                               1.000    0.685
   .item15            1.000                               1.000    0.780
   .item16            1.000                               1.000    0.605
   .item17            1.000                               1.000    0.605
   .item18            1.000                               1.000    0.497
   .item19            1.000                               1.000    0.465
   .item20            1.000                               1.000    0.542
   .item21            1.000                               1.000    0.951
   .item22            1.000                               1.000    0.851
   .item23            1.000                               1.000    0.685
   .item24            1.000                               1.000    0.740
   .item25            1.000                               1.000    0.684
   .item26            1.000                               1.000    0.631
   .item27            1.000                               1.000    0.758
   .item28            1.000                               1.000    0.576
   .item29            1.000                               1.000    0.904
   .item30            1.000                               1.000    0.801
    theta1            1.000                               1.000    1.000
    theta2            1.000                               1.000    1.000
    theta3            1.000                               1.000    1.000
    theta4            1.000                               1.000    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11            0.686                               0.686    1.000
    item12            0.956                               0.956    1.000
    item13            0.738                               0.738    1.000
    item14            0.828                               0.828    1.000
    item15            0.883                               0.883    1.000
    item16            0.778                               0.778    1.000
    item17            0.778                               0.778    1.000
    item18            0.705                               0.705    1.000
    item19            0.682                               0.682    1.000
    item20            0.736                               0.736    1.000
    item21            0.975                               0.975    1.000
    item22            0.922                               0.922    1.000
    item23            0.827                               0.827    1.000
    item24            0.860                               0.860    1.000
    item25            0.827                               0.827    1.000
    item26            0.795                               0.795    1.000
    item27            0.871                               0.871    1.000
    item28            0.759                               0.759    1.000
    item29            0.951                               0.951    1.000
    item30            0.895                               0.895    1.000</code></pre>
</div>
</div>
</section>
<section id="multidimensional-model-path-diagram" class="level3">
<h3 class="anchored" data-anchor-id="multidimensional-model-path-diagram">Multidimensional Model Path Diagram</h3>
<div class="cell" data-layout-align="center" data-hash="14_Subscores_and_Popular_Models_cache/html/plotMultidimensionalModel_2bfd402eeece41805ebe6b622f67c70b">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(multidimensionalModel, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sizeMan =</span> <span class="fl">2.5</span>, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">style =</span> <span class="st">"mx"</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">intercepts =</span> <span class="cn">FALSE</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">thresholds =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/plotMultidimensionalModel-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-score-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="model-score-comparisons">Model Score Comparisons</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-5_2f640be9f957f6be9e821e01dfbac1f3">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>multidimensionalScores <span class="ot">=</span> <span class="fu">lavPredict</span>(multidimensionalModel)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>allScores <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(unidimensionalScores, multidimensionalScores))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(allScores) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"uTheta"</span>, <span class="fu">paste0</span>(<span class="st">"mTheta"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(allScores, <span class="at">main =</span>  <span class="st">"Unidimensional Score vs. Multidimensional Scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(allScores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           uTheta   mTheta1   mTheta2   mTheta3   mTheta4
uTheta  1.0000000 0.9763872 0.9734620 0.8953982 0.9324452
mTheta1 0.9763872 1.0000000 0.9249558 0.8119392 0.9400688
mTheta2 0.9734620 0.9249558 1.0000000 0.8657125 0.8361691
mTheta3 0.8953982 0.8119392 0.8657125 1.0000000 0.8101180
mTheta4 0.9324452 0.9400688 0.8361691 0.8101180 1.0000000</code></pre>
</div>
</div>
</section>
<section id="model-fit-comparison" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-comparison">Model Fit Comparison</h3>
<p>Which model fits the data better? Chi-square difference test:</p>
<p>Note: Comparison is only unidimensional IRT model vs.&nbsp;Multidimensional IRT model</p>
<ul>
<li>Sumscore-based MCFA model not comparable as likelihood is on different scale
<ul>
<li>Observed variables Bernoulli distributed in IRT</li>
<li>Observed variables normally distributed in CFA</li>
</ul></li>
</ul>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-6_285c92737bd9304985f382ccb8797314">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(unidimensionalModel, multidimensionalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Scaled Chi-Squared Difference Test (method = "satorra.2000")

lavaan NOTE:
    The "Chisq" column contains standard test statistics, not the
    robust test that should be reported per model. A robust difference
    test is a function of two standard (not robust) statistics.
 
                       Df AIC BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)    
multidimensionalModel 164         233.93                                  
unidimensionalModel   170         419.00      146.5       6  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The MIRT model fits better than the unidimensional model</p>
<ul>
<li>So, if reporting both types of scores, discrepancies can arise
<ul>
<li>Differing models may have competing information</li>
</ul></li>
<li>Which score is more accurate?
<ul>
<li>Both cannot be correct</li>
</ul></li>
</ul>
</section>
<section id="option-2-summed-multidimensional-model-scores" class="level3">
<h3 class="anchored" data-anchor-id="option-2-summed-multidimensional-model-scores">Option 2: Summed Multidimensional Model Scores</h3>
<p>Another option for reporting subscores and an overall score is to:</p>
<ul>
<li>Estimate subscores from the MIRT model</li>
<li>Create the total score with the sum of each of the latent variable estimates from the MIRT model:</li>
</ul>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-7_f1d3f0ed70fa15a25a3d4afd9eb33b7b">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>totalMIRTScores <span class="ot">=</span> <span class="fu">rowSums</span>(multidimensionalScores)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> unidimensionalScores, <span class="at">y =</span> totalMIRTScores, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Unidimensional Score vs. Sum of Multidimensional Scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> unidimensionalScores, <span class="at">y =</span> totalMIRTScores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
theta 0.9973215</code></pre>
</div>
</div>
</section>
<section id="evaluating-option-2" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-option-2">Evaluating Option 2</h3>
<p>Option 2 is closer to what is needed in that it uses MIRT to form a total score</p>
<ul>
<li>But, what is the model that Option 2 implies?</li>
</ul>
<p><span class="math display">\[
\begin{array}{c}
\theta_{p1} = \mu_1 + \lambda F + e_{p1}; e \sim N(0, \psi^2) \\
\theta_{p2} = \mu_2 + \lambda F + e_{p2}; e \sim N(0, \psi^2) \\
\theta_{p3} = \mu_3 + \lambda F + e_{p3}; e \sim N(0, \psi^2) \\
\theta_{p4} = \mu_4 + \lambda F + e_{p4}; e \sim N(0, \psi^2) \\
\end{array}
\]</span></p>
<p>Where <span class="math inline">\(F \sim N(0, 1)\)</span></p>
</section>
<section id="testing-if-summed-mirt-score-model-fits-data" class="level3">
<h3 class="anchored" data-anchor-id="testing-if-summed-mirt-score-model-fits-data">Testing if Summed MIRT Score Model Fits Data</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-8_87d9530c2a4ab2ab6e0c6a1f20415d0f">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>summedMIRT_syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st"># constrain all loadings to be equal</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">total =~ L1*theta1 + L1*theta2 + L1*theta3 + L1*theta4</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st"># set the unique variances to be equal</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 ~~ U1*theta1; theta2 ~~ U1*theta2; theta3 ~~ U1*theta3; theta4 ~~ U1*theta4;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>summedMIRTModel <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> summedMIRT_syntax, </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> multidimensionalScores, </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"MLR"</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(summedMIRTModel, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 10 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         8
  Number of equality constraints                     6

  Number of observations                          1099

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                              1240.195    1493.422
  Degrees of freedom                                 8           8
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.830
    Yuan-Bentler correction (Mplus variant)                       

Model Test Baseline Model:

  Test statistic                              6334.409    8515.633
  Degrees of freedom                                 6           6
  P-value                                        0.000       0.000
  Scaling correction factor                                  0.744

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.805       0.825
  Tucker-Lewis Index (TLI)                       0.854       0.869
                                                                  
  Robust Comparative Fit Index (CFI)                         0.805
  Robust Tucker-Lewis Index (TLI)                            0.854

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -2772.002   -2772.002
  Scaling correction factor                                  0.303
      for the MLR correction                                      
  Loglikelihood unrestricted model (H1)      -2151.905   -2151.905
  Scaling correction factor                                  0.907
      for the MLR correction                                      
                                                                  
  Akaike (AIC)                                5548.005    5548.005
  Bayesian (BIC)                              5558.009    5558.009
  Sample-size adjusted Bayesian (SABIC)       5551.657    5551.657

Root Mean Square Error of Approximation:

  RMSEA                                          0.374       0.411
  90 Percent confidence interval - lower         0.357       0.392
  90 Percent confidence interval - upper         0.392       0.430
  P-value H_0: RMSEA &lt;= 0.050                    0.000       0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000       1.000
                                                                  
  Robust RMSEA                                               0.375
  90 Percent confidence interval - lower                     0.359
  90 Percent confidence interval - upper                     0.391
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.000
  P-value H_0: Robust RMSEA &gt;= 0.080                         1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.128       0.128

Parameter Estimates:

  Standard errors                             Sandwich
  Information bread                           Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  total =~                                                              
    theta1    (L1)    0.757    0.019   40.075    0.000    0.757    0.929
    theta2    (L1)    0.757    0.019   40.075    0.000    0.757    0.929
    theta3    (L1)    0.757    0.019   40.075    0.000    0.757    0.929
    theta4    (L1)    0.757    0.019   40.075    0.000    0.757    0.929

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .theta1    (U1)    0.091    0.002   37.596    0.000    0.091    0.138
   .theta2    (U1)    0.091    0.002   37.596    0.000    0.091    0.138
   .theta3    (U1)    0.091    0.002   37.596    0.000    0.091    0.138
   .theta4    (U1)    0.091    0.002   37.596    0.000    0.091    0.138
    total             1.000                               1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="demonstrating-equivalence-scalar-with-summed-mirt-scores" class="level3">
<h3 class="anchored" data-anchor-id="demonstrating-equivalence-scalar-with-summed-mirt-scores">Demonstrating Equivalence (Scalar) with Summed MIRT Scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>summedMIRTScores <span class="ot">=</span> <span class="fu">lavPredict</span>(summedMIRTModel)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> summedMIRTScores, <span class="at">y =</span> totalMIRTScores, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Summed MIRT Score vs. Sum of Multidimensional Scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="option-3-bifactor-model" class="level2">
<h2 class="anchored" data-anchor-id="option-3-bifactor-model">Option #3: Bifactor Model</h2>
<p>A bifactor model is a multidimensional model where:</p>
<ul>
<li>Each item loads on a general factor and a specific factor</li>
<li>The general factor is uncorrelated with the specific factors</li>
<li>The specific factors can be uncorrelated with each other (as a method factor) or correlated with each other (as a multidimensional model)</li>
</ul>
<section id="bifactor-model-notation" class="level3">
<h3 class="anchored" data-anchor-id="bifactor-model-notation">Bifactor Model Notation</h3>
<p>The bifactor model is:</p>
<p>Subscore 1:</p>
<p><span class="math display">\[
\begin{array}{c}
\text{logit}\left( P\left( Y_{p1} = 1 \mid \theta_{p1}, g_p \right) \right) = \mu_1 + \lambda_{11} \theta_{p1} + \lambda_{1g} g_p \\
\text{logit}\left( P\left( Y_{p2} = 1 \mid \theta_{p2}, g_p \right) \right) = \mu_2 + \lambda_{21} \theta_{p1} + \lambda_{2g} g_p \\
\vdots \\
\text{logit}\left( P\left( Y_{p5} = 1 \mid \theta_{p5}, g_p \right) \right) = \mu_5 + \lambda_{51} \theta_{p1} + \lambda_{5g} g_p \\
\end{array}
\]</span></p>
<p>Subscore 2:</p>
<p><span class="math display">\[
\begin{array}{c}
\text{logit}\left( P\left( Y_{p6} = 1 \mid \theta_{p6}, g_p \right) \right) = \mu_6 + \lambda_{61} \theta_{p2} + \lambda_{6g} g_p \\
\text{logit}\left( P\left( Y_{p7} = 1 \mid \theta_{p7}, g_p \right) \right) = \mu_7 + \lambda_{71} \theta_{p2} + \lambda_{7g} g_p \\
\vdots \\
\text{logit}\left( P\left( Y_{p10} = 1 \mid \theta_{p10}, g_p \right) \right) = \mu_{10} + \lambda_{101} \theta_{p2} + \lambda_{10g} g_p \\
\end{array}
\]</span></p>
</section>
<section id="bifactor-model-in-lavaan" class="level3">
<h3 class="anchored" data-anchor-id="bifactor-model-in-lavaan">Bifactor Model in <code>lavaan</code></h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-10_ce0ead30247431146a73de2b46b93e07">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bifactorModel_syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="st">g =~ item11 + item12 + item13 + item14 + item15 + </span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="st">     item16 + item17 + item18 + item19 + item20 + </span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="st">     item21 + item22 + item23 + item24 + item25 + </span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="st">     item26 + item27 + item28 + item29 + item30</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="st">         </span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 =~ item11 + item12 + item13 + item14 + item15</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="st">theta2 =~ item16 + item17 + item18 + item19 + item20</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="st">theta3 =~ item21 + item22 + item23 + item24 + item25</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="st">theta4 =~ item26 + item27 + item28 + item29 + item30</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="st">g ~~ 0*theta1</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="st">g ~~ 0*theta2</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="st">g ~~ 0*theta3</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="st">g ~~ 0*theta4</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>bifactorModel <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> bifactorModel_syntax, </span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> responseMatrix, </span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"WLSMV"</span>, </span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>), </span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameterization =</span> <span class="st">"theta"</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bifactorModel, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 85 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        66

                                                  Used       Total
  Number of observations                          1099        2541

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               122.416     169.422
  Degrees of freedom                               144         144
  P-value (Chi-square)                           0.904       0.073
  Scaling correction factor                                  0.787
  Shift parameter                                           13.922
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                              5341.853    3322.839
  Degrees of freedom                               190         190
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.644

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000       0.992
  Tucker-Lewis Index (TLI)                       1.006       0.989
                                                                  
  Robust Comparative Fit Index (CFI)                         0.977
  Robust Tucker-Lewis Index (TLI)                            0.969

Root Mean Square Error of Approximation:

  RMSEA                                          0.000       0.013
  90 Percent confidence interval - lower         0.000       0.000
  90 Percent confidence interval - upper         0.006       0.020
  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.027
  90 Percent confidence interval - lower                     0.005
  90 Percent confidence interval - upper                     0.040
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.999
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.037       0.037

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g =~                                                                  
    item11            0.746    0.098    7.627    0.000    0.746    0.505
    item12            0.364    0.071    5.161    0.000    0.364    0.342
    item13            0.615    0.083    7.454    0.000    0.615    0.439
    item14            0.495    0.067    7.333    0.000    0.495    0.410
    item15            0.416    0.060    6.956    0.000    0.416    0.369
    item16            0.291    0.082    3.557    0.000    0.291    0.201
    item17            0.396    0.068    5.803    0.000    0.396    0.304
    item18            0.524    0.078    6.715    0.000    0.524    0.369
    item19            0.551    0.083    6.664    0.000    0.551    0.375
    item20            0.683    0.083    8.276    0.000    0.683    0.519
    item21            0.213    0.056    3.835    0.000    0.213    0.208
    item22            0.409    0.077    5.279    0.000    0.409    0.378
    item23            0.470    0.077    6.098    0.000    0.470    0.396
    item24            0.351    0.101    3.482    0.000    0.351    0.242
    item25            0.457    0.075    6.137    0.000    0.457    0.382
    item26            0.755    0.094    8.064    0.000    0.755    0.597
    item27            0.396    0.074    5.346    0.000    0.396    0.327
    item28            0.727    0.171    4.245    0.000    0.727    0.439
    item29            0.402    0.079    5.056    0.000    0.402    0.372
    item30            0.527    0.074    7.148    0.000    0.527    0.466
  theta1 =~                                                             
    item11            0.792    0.133    5.943    0.000    0.792    0.536
    item12            0.020    0.078    0.260    0.795    0.020    0.019
    item13            0.762    0.119    6.389    0.000    0.762    0.544
    item14            0.460    0.088    5.216    0.000    0.460    0.381
    item15            0.315    0.078    4.063    0.000    0.315    0.279
  theta2 =~                                                             
    item16            1.003    0.126    7.941    0.000    1.003    0.694
    item17            0.736    0.087    8.432    0.000    0.736    0.565
    item18            0.860    0.101    8.533    0.000    0.860    0.606
    item19            0.926    0.108    8.558    0.000    0.926    0.630
    item20            0.517    0.087    5.965    0.000    0.517    0.392
  theta3 =~                                                             
    item21            0.070    0.065    1.069    0.285    0.070    0.068
    item22            0.039    0.077    0.498    0.618    0.039    0.036
    item23            0.435    0.095    4.590    0.000    0.435    0.367
    item24            0.991    0.250    3.973    0.000    0.991    0.683
    item25            0.477    0.097    4.917    0.000    0.477    0.398
  theta4 =~                                                             
    item26            0.171    0.100    1.709    0.087    0.171    0.135
    item27            0.557    0.130    4.283    0.000    0.557    0.460
    item28            1.100    0.374    2.939    0.003    1.100    0.665
    item29           -0.072    0.090   -0.792    0.428   -0.072   -0.066
    item30            0.040    0.093    0.429    0.668    0.040    0.035

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g ~~                                                                  
    theta1            0.000                               0.000    0.000
    theta2            0.000                               0.000    0.000
    theta3            0.000                               0.000    0.000
    theta4            0.000                               0.000    0.000
  theta1 ~~                                                             
    theta2            0.619    0.065    9.571    0.000    0.619    0.619
    theta3            0.018    0.114    0.161    0.872    0.018    0.018
    theta4            0.430    0.111    3.880    0.000    0.430    0.430
  theta2 ~~                                                             
    theta3            0.419    0.074    5.702    0.000    0.419    0.419
    theta4            0.275    0.090    3.072    0.002    0.275    0.275
  theta3 ~~                                                             
    theta4           -0.068    0.114   -0.599    0.549   -0.068   -0.068

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            0.000                               0.000    0.000
   .item12            0.000                               0.000    0.000
   .item13            0.000                               0.000    0.000
   .item14            0.000                               0.000    0.000
   .item15            0.000                               0.000    0.000
   .item16            0.000                               0.000    0.000
   .item17            0.000                               0.000    0.000
   .item18            0.000                               0.000    0.000
   .item19            0.000                               0.000    0.000
   .item20            0.000                               0.000    0.000
   .item21            0.000                               0.000    0.000
   .item22            0.000                               0.000    0.000
   .item23            0.000                               0.000    0.000
   .item24            0.000                               0.000    0.000
   .item25            0.000                               0.000    0.000
   .item26            0.000                               0.000    0.000
   .item27            0.000                               0.000    0.000
   .item28            0.000                               0.000    0.000
   .item29            0.000                               0.000    0.000
   .item30            0.000                               0.000    0.000
    g                 0.000                               0.000    0.000
    theta1            0.000                               0.000    0.000
    theta2            0.000                               0.000    0.000
    theta3            0.000                               0.000    0.000
    theta4            0.000                               0.000    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11|t1         0.514    0.067    7.644    0.000    0.514    0.348
    item12|t1         0.660    0.046   14.349    0.000    0.660    0.620
    item13|t1         0.142    0.054    2.631    0.009    0.142    0.102
    item14|t1         0.137    0.046    2.957    0.003    0.137    0.113
    item15|t1         0.084    0.043    1.954    0.051    0.084    0.074
    item16|t1        -0.167    0.055   -3.029    0.002   -0.167   -0.115
    item17|t1        -0.040    0.049   -0.815    0.415   -0.040   -0.031
    item18|t1        -0.047    0.054   -0.876    0.381   -0.047   -0.033
    item19|t1        -0.123    0.056   -2.207    0.027   -0.123   -0.083
    item20|t1         0.621    0.059   10.475    0.000    0.621    0.472
    item21|t1         0.268    0.039    6.804    0.000    0.268    0.262
    item22|t1         0.851    0.052   16.506    0.000    0.851    0.787
    item23|t1         0.679    0.056   12.119    0.000    0.679    0.571
    item24|t1         0.696    0.108    6.468    0.000    0.696    0.480
    item25|t1         0.532    0.053   10.035    0.000    0.532    0.444
    item26|t1         0.679    0.062   11.017    0.000    0.679    0.537
    item27|t1         0.190    0.047    4.008    0.000    0.190    0.157
    item28|t1         0.488    0.113    4.334    0.000    0.488    0.295
    item29|t1         0.817    0.052   15.670    0.000    0.817    0.756
    item30|t1         0.580    0.049   11.860    0.000    0.580    0.513

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            1.000                               1.000    0.458
   .item12            1.000                               1.000    0.882
   .item13            1.000                               1.000    0.511
   .item14            1.000                               1.000    0.687
   .item15            1.000                               1.000    0.786
   .item16            1.000                               1.000    0.478
   .item17            1.000                               1.000    0.589
   .item18            1.000                               1.000    0.497
   .item19            1.000                               1.000    0.463
   .item20            1.000                               1.000    0.577
   .item21            1.000                               1.000    0.952
   .item22            1.000                               1.000    0.856
   .item23            1.000                               1.000    0.709
   .item24            1.000                               1.000    0.475
   .item25            1.000                               1.000    0.696
   .item26            1.000                               1.000    0.626
   .item27            1.000                               1.000    0.682
   .item28            1.000                               1.000    0.365
   .item29            1.000                               1.000    0.857
   .item30            1.000                               1.000    0.782
    g                 1.000                               1.000    1.000
    theta1            1.000                               1.000    1.000
    theta2            1.000                               1.000    1.000
    theta3            1.000                               1.000    1.000
    theta4            1.000                               1.000    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11            0.677                               0.677    1.000
    item12            0.939                               0.939    1.000
    item13            0.715                               0.715    1.000
    item14            0.829                               0.829    1.000
    item15            0.887                               0.887    1.000
    item16            0.692                               0.692    1.000
    item17            0.767                               0.767    1.000
    item18            0.705                               0.705    1.000
    item19            0.680                               0.680    1.000
    item20            0.759                               0.759    1.000
    item21            0.976                               0.976    1.000
    item22            0.925                               0.925    1.000
    item23            0.842                               0.842    1.000
    item24            0.689                               0.689    1.000
    item25            0.834                               0.834    1.000
    item26            0.791                               0.791    1.000
    item27            0.826                               0.826    1.000
    item28            0.604                               0.604    1.000
    item29            0.926                               0.926    1.000
    item30            0.884                               0.884    1.000</code></pre>
</div>
</div>
</section>
<section id="bifactor-model-path-diagram" class="level3">
<h3 class="anchored" data-anchor-id="bifactor-model-path-diagram">Bifactor Model Path Diagram</h3>
<div class="cell" data-layout-align="center" data-hash="14_Subscores_and_Popular_Models_cache/html/plotBifactorModel_99030bbf91217d72b378e42f4bb42406">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(bifactorModel, <span class="at">sizeMan =</span> <span class="fl">2.5</span>, <span class="at">style =</span> <span class="st">"mx"</span>, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">thresholds =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/plotBifactorModel-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note: as rendered when this lecture was constructed, the plot has correlations between <span class="math inline">\(g\)</span> and the <span class="math inline">\(\theta\)</span>, which are not present in the model</p>
</section>
<section id="bifactor-model-score-comparisons-unidimensional-irt-model-theta-vs.-bifactor-irt-model-g" class="level3">
<h3 class="anchored" data-anchor-id="bifactor-model-score-comparisons-unidimensional-irt-model-theta-vs.-bifactor-irt-model-g">Bifactor Model Score Comparisons: Unidimensional IRT model <span class="math inline">\(\theta\)</span> vs.&nbsp;Bifactor IRT model <span class="math inline">\(g\)</span></h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-11_65ac438a2f9ab32ee83123e0c7f8a491">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bifactorScores <span class="ot">=</span> <span class="fu">lavPredict</span>(bifactorModel)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> unidimensionalScores, <span class="at">y =</span> bifactorScores[, <span class="st">"g"</span>], </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Unidimensional Score vs. Bifactor Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bifactor-model-score-comparisons-standards" class="level3">
<h3 class="anchored" data-anchor-id="bifactor-model-score-comparisons-standards">Bifactor Model Score Comparisons: Standards</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-12_cf76f69da47d54ff97903e30d0966697">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">1</span>], <span class="at">y =</span> bifactorScores[, <span class="st">"theta1"</span>],</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Bifactor Score for Theta 1"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">2</span>], <span class="at">y =</span> bifactorScores[, <span class="st">"theta2"</span>],</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Bifactor Score for Theta 1"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">3</span>], <span class="at">y =</span> bifactorScores[, <span class="st">"theta3"</span>],</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Bifactor Score for Theta 1"</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">4</span>], <span class="at">y =</span> bifactorScores[, <span class="st">"theta4"</span>],</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Bifactor Score for Theta 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="from-score-plot-scores-are-not-same" class="level3">
<h3 class="anchored" data-anchor-id="from-score-plot-scores-are-not-same">From Score Plot: Scores are Not Same</h3>
<p>The bifactor model scores are not the same as the multidimensional model scores</p>
<ul>
<li>The general factor is not the same as total score in the unidimensional model
<ul>
<li>Rather, it is the score of the domain that does not include the subdomains</li>
<li>Put another way: It is everything left over in algebra after controlling for a person’s ability in the algebra standards</li>
<li>Sometimes considered a residual</li>
</ul></li>
</ul>
</section>
<section id="model-fit-comparison-1" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-comparison-1">Model Fit Comparison</h3>
<p>But…the bifactor model nearly always fits better than a similar multidimensional model</p>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-13_a9973ef9349e6b2b4e9736d2b792d361">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(unidimensionalModel, multidimensionalModel, bifactorModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Scaled Chi-Squared Difference Test (method = "satorra.2000")

lavaan NOTE:
    The "Chisq" column contains standard test statistics, not the
    robust test that should be reported per model. A robust difference
    test is a function of two standard (not robust) statistics.
 
                       Df AIC BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)    
bifactorModel         144         122.42                                  
multidimensionalModel 164         233.93     110.74      20  1.442e-14 ***
unidimensionalModel   170         419.00     146.50       6  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="option-4-higher-order-model" class="level3">
<h3 class="anchored" data-anchor-id="option-4-higher-order-model">Option #4: Higher Order Model</h3>
<p>A higher order model is a multidimensional model where:</p>
<ul>
<li>Each item loads onto its subdomain factor, identically with the multidimensional model (MIRT)</li>
<li>Each factor then loads onto a general factor</li>
</ul>
</section>
<section id="higher-order-model-notation" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-model-notation">Higher Order Model Notation</h3>
<p>Subscore 1:</p>
<p><span class="math display">\[
\begin{array}{c}
\text{logit}\left( P\left( Y_{p1} = 1 \mid \theta_{p1} \right) \right) = \mu_1 + \lambda_{11} \theta_{p1} \\
\text{logit}\left( P\left( Y_{p2} = 1 \mid \theta_{p2} \right) \right) = \mu_2 + \lambda_{21} \theta_{p1} \\
\vdots \\
\text{logit}\left( P\left( Y_{p5} = 1 \mid \theta_{p5} \right) \right) = \mu_5 + \lambda_{51} \theta_{p1} \\
\end{array}
\]</span></p>
<p>Subscore 2:</p>
<p><span class="math display">\[
\begin{array}{c}
\text{logit}\left( P\left( Y_{p6} = 1 \mid \theta_{p6} \right) \right) = \mu_6 + \lambda_{61} \theta_{p2} \\
\text{logit}\left( P\left( Y_{p7} = 1 \mid \theta_{p7} \right) \right) = \mu_7 + \lambda_{71} \theta_{p2} \\
\vdots \\
\text{logit}\left( P\left( Y_{p10} = 1 \mid \theta_{p10} \right) \right) = \mu_{10} + \lambda_{101} \theta_{p2} \\
\end{array}
\]</span></p>
<p>Structural Model – a unidimensional CFA model for the subdomains:</p>
<p><span class="math display">\[
\begin{array}{c}
\theta_{p1} = \mu_1 + \lambda_{1} F + e_{p1}; e_{p1} \sim N(0, \psi^2_1) \\
\theta_{p2} = \mu_2 + \lambda_{2} F + e_{p2}; e_{p2} \sim N(0, \psi^2_2) \\
\theta_{p3} = \mu_3 + \lambda_{3} F + e_{p3}; e_{p3} \sim N(0, \psi^2_3) \\
\theta_{p4} = \mu_4 + \lambda_{4} F + e_{p4}; e_{p4} \sim N(0, \psi^2_4) \\
\end{array}
\]</span></p>
</section>
<section id="model-implied-covariance-matrix-of-subdomain-latent-variables" class="level3">
<h3 class="anchored" data-anchor-id="model-implied-covariance-matrix-of-subdomain-latent-variables">Model-Implied Covariance Matrix of Subdomain Latent Variables</h3>
<p><span class="math display">\[
\begin{bmatrix}
\theta_{p1} \\
\theta_{p2} \\
\theta_{p3} \\
\theta_{p4} \\
\end{bmatrix}
\sim N \left(\boldsymbol{0}, \boldsymbol{\Sigma}_{M} \right)
\]</span></p>
<p>Where:</p>
<p><span class="math display">\[
\mathbf{\Sigma}_{M} = \mathbf{\Lambda} \mathbf{\Phi} \mathbf{\Lambda}^T + \boldsymbol{\Psi}
\]</span></p>
<p>So, the higher order model is the MIRT model with a more restricted structure on the covariance matrix of the subdomain latent variables</p>
</section>
<section id="higher-order-model-in-lavaan" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-model-in-lavaan">Higher Order Model in <code>lavaan</code></h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-14_11a8d6369b25af2e3368e5ce381581d8">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>higherOrderModel_syntax <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="st">theta1 =~ item11 + item12 + item13 + item14 + item15</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">theta2 =~ item16 + item17 + item18 + item19 + item20</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">theta3 =~ item21 + item22 + item23 + item24 + item25</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="st">theta4 =~ item26 + item27 + item28 + item29 + item30</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="st">algebra =~ theta1 + theta2 + theta3 + theta4</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>higherOrderModel <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> higherOrderModel_syntax, </span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> responseMatrix, </span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">"WLSMV"</span>, </span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="fu">paste0</span>(<span class="st">"item"</span>, <span class="dv">11</span><span class="sc">:</span><span class="dv">30</span>), </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameterization =</span> <span class="st">"theta"</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(higherOrderModel, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.15 ended normally after 47 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        44

                                                  Used       Total
  Number of observations                          1099        2541

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                               252.420     317.925
  Degrees of freedom                               166         166
  P-value (Chi-square)                           0.000       0.000
  Scaling correction factor                                  0.843
  Shift parameter                                           18.646
    simple second-order correction                                

Model Test Baseline Model:

  Test statistic                              5341.853    3322.839
  Degrees of freedom                               190         190
  P-value                                        0.000       0.000
  Scaling correction factor                                  1.644

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.983       0.952
  Tucker-Lewis Index (TLI)                       0.981       0.944
                                                                  
  Robust Comparative Fit Index (CFI)                         0.907
  Robust Tucker-Lewis Index (TLI)                            0.894

Root Mean Square Error of Approximation:

  RMSEA                                          0.022       0.029
  90 Percent confidence interval - lower         0.016       0.024
  90 Percent confidence interval - upper         0.027       0.034
  P-value H_0: RMSEA &lt;= 0.050                    1.000       1.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000       0.000
                                                                  
  Robust RMSEA                                               0.050
  90 Percent confidence interval - lower                     0.040
  90 Percent confidence interval - upper                     0.059
  P-value H_0: Robust RMSEA &lt;= 0.050                         0.501
  P-value H_0: Robust RMSEA &gt;= 0.080                         0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.053       0.053

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  theta1 =~                                                             
    item11            0.425    0.102    4.153    0.000    1.057    0.726
    item12            0.124    0.034    3.692    0.000    0.309    0.295
    item13            0.367    0.086    4.282    0.000    0.913    0.674
    item14            0.272    0.063    4.315    0.000    0.675    0.560
    item15            0.215    0.050    4.287    0.000    0.534    0.471
  theta2 =~                                                             
    item16            0.463    0.054    8.583    0.000    0.808    0.628
    item17            0.464    0.055    8.394    0.000    0.809    0.629
    item18            0.575    0.070    8.195    0.000    1.003    0.708
    item19            0.614    0.074    8.326    0.000    1.071    0.731
    item20            0.529    0.072    7.300    0.000    0.922    0.678
  theta3 =~                                                             
    item21            0.168    0.043    3.946    0.000    0.229    0.223
    item22            0.312    0.059    5.306    0.000    0.426    0.392
    item23            0.498    0.076    6.551    0.000    0.680    0.563
    item24            0.424    0.062    6.847    0.000    0.579    0.501
    item25            0.499    0.074    6.769    0.000    0.681    0.563
  theta4 =~                                                             
    item26            0.485    0.074    6.591    0.000    0.768    0.609
    item27            0.356    0.047    7.504    0.000    0.563    0.491
    item28            0.544    0.075    7.231    0.000    0.860    0.652
    item29            0.205    0.045    4.533    0.000    0.324    0.308
    item30            0.314    0.048    6.545    0.000    0.496    0.444
  algebra =~                                                            
    theta1            2.276    0.539    4.225    0.000    0.916    0.916
    theta2            1.429    0.167    8.557    0.000    0.819    0.819
    theta3            0.929    0.122    7.601    0.000    0.681    0.681
    theta4            1.225    0.159    7.692    0.000    0.775    0.775

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            0.000                               0.000    0.000
   .item12            0.000                               0.000    0.000
   .item13            0.000                               0.000    0.000
   .item14            0.000                               0.000    0.000
   .item15            0.000                               0.000    0.000
   .item16            0.000                               0.000    0.000
   .item17            0.000                               0.000    0.000
   .item18            0.000                               0.000    0.000
   .item19            0.000                               0.000    0.000
   .item20            0.000                               0.000    0.000
   .item21            0.000                               0.000    0.000
   .item22            0.000                               0.000    0.000
   .item23            0.000                               0.000    0.000
   .item24            0.000                               0.000    0.000
   .item25            0.000                               0.000    0.000
   .item26            0.000                               0.000    0.000
   .item27            0.000                               0.000    0.000
   .item28            0.000                               0.000    0.000
   .item29            0.000                               0.000    0.000
   .item30            0.000                               0.000    0.000
   .theta1            0.000                               0.000    0.000
   .theta2            0.000                               0.000    0.000
   .theta3            0.000                               0.000    0.000
   .theta4            0.000                               0.000    0.000
    algebra           0.000                               0.000    0.000

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11|t1         0.506    0.065    7.821    0.000    0.506    0.348
    item12|t1         0.649    0.044   14.879    0.000    0.649    0.620
    item13|t1         0.138    0.052    2.639    0.008    0.138    0.102
    item14|t1         0.137    0.046    2.956    0.003    0.137    0.113
    item15|t1         0.084    0.043    1.953    0.051    0.084    0.074
    item16|t1        -0.148    0.049   -3.060    0.002   -0.148   -0.115
    item17|t1        -0.040    0.049   -0.816    0.415   -0.040   -0.031
    item18|t1        -0.047    0.053   -0.877    0.381   -0.047   -0.033
    item19|t1        -0.122    0.055   -2.215    0.027   -0.122   -0.083
    item20|t1         0.642    0.064   10.093    0.000    0.642    0.472
    item21|t1         0.269    0.040    6.795    0.000    0.269    0.262
    item22|t1         0.855    0.052   16.352    0.000    0.855    0.787
    item23|t1         0.691    0.059   11.691    0.000    0.691    0.571
    item24|t1         0.554    0.051   10.964    0.000    0.554    0.480
    item25|t1         0.537    0.054    9.881    0.000    0.537    0.444
    item26|t1         0.677    0.062   10.991    0.000    0.677    0.537
    item27|t1         0.180    0.044    4.071    0.000    0.180    0.157
    item28|t1         0.389    0.056    6.990    0.000    0.389    0.295
    item29|t1         0.795    0.047   16.813    0.000    0.795    0.756
    item30|t1         0.573    0.047   12.091    0.000    0.573    0.513

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .item11            1.000                               1.000    0.472
   .item12            1.000                               1.000    0.913
   .item13            1.000                               1.000    0.545
   .item14            1.000                               1.000    0.687
   .item15            1.000                               1.000    0.778
   .item16            1.000                               1.000    0.605
   .item17            1.000                               1.000    0.604
   .item18            1.000                               1.000    0.499
   .item19            1.000                               1.000    0.466
   .item20            1.000                               1.000    0.540
   .item21            1.000                               1.000    0.950
   .item22            1.000                               1.000    0.847
   .item23            1.000                               1.000    0.684
   .item24            1.000                               1.000    0.749
   .item25            1.000                               1.000    0.683
   .item26            1.000                               1.000    0.629
   .item27            1.000                               1.000    0.759
   .item28            1.000                               1.000    0.575
   .item29            1.000                               1.000    0.905
   .item30            1.000                               1.000    0.803
   .theta1            1.000                               0.162    0.162
   .theta2            1.000                               0.329    0.329
   .theta3            1.000                               0.537    0.537
   .theta4            1.000                               0.400    0.400
    algebra           1.000                               1.000    1.000

Scales y*:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    item11            0.687                               0.687    1.000
    item12            0.955                               0.955    1.000
    item13            0.738                               0.738    1.000
    item14            0.829                               0.829    1.000
    item15            0.882                               0.882    1.000
    item16            0.778                               0.778    1.000
    item17            0.777                               0.777    1.000
    item18            0.706                               0.706    1.000
    item19            0.683                               0.683    1.000
    item20            0.735                               0.735    1.000
    item21            0.975                               0.975    1.000
    item22            0.920                               0.920    1.000
    item23            0.827                               0.827    1.000
    item24            0.865                               0.865    1.000
    item25            0.826                               0.826    1.000
    item26            0.793                               0.793    1.000
    item27            0.871                               0.871    1.000
    item28            0.758                               0.758    1.000
    item29            0.951                               0.951    1.000
    item30            0.896                               0.896    1.000</code></pre>
</div>
</div>
</section>
<section id="higher-order-model-path-diagram" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-model-path-diagram">Higher Order Model Path Diagram</h3>
<div class="cell" data-layout-align="center" data-hash="14_Subscores_and_Popular_Models_cache/html/plotHigherOrderModel_63154ecaa6c727274c69c6b8c32b4dac">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>semPlot<span class="sc">::</span><span class="fu">semPaths</span>(higherOrderModel, <span class="at">sizeMan =</span> <span class="fl">2.5</span>, <span class="at">style =</span> <span class="st">"mx"</span>, <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">thresholds =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/plotHigherOrderModel-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="higher-order-model-score-comparisons-unidimensional-irt-model-theta-vs.-higher-order-irt-model-f" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-model-score-comparisons-unidimensional-irt-model-theta-vs.-higher-order-irt-model-f">Higher Order Model Score Comparisons: Unidimensional IRT model <span class="math inline">\(\theta\)</span> vs.&nbsp;Higher Order IRT model <span class="math inline">\(F\)</span></h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-15_187e6503361d7cff8c50089b983186f1">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>higherOrderScores <span class="ot">=</span> <span class="fu">lavPredict</span>(higherOrderModel)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> unidimensionalScores, <span class="at">y =</span> higherOrderScores[, <span class="st">"algebra"</span>], </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Unidimensional Score vs. Higher Order Score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="higher-order-model-score-comparisons-standards" class="level3">
<h3 class="anchored" data-anchor-id="higher-order-model-score-comparisons-standards">Higher Order Model Score Comparisons: Standards</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-16_766917ee82e0283a669efd8f148e22f3">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">1</span>], <span class="at">y =</span> higherOrderScores[, <span class="st">"theta1"</span>],</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Higher Order Score for Theta 1"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">2</span>], <span class="at">y =</span> higherOrderScores[, <span class="st">"theta2"</span>],</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Higher Order Score for Theta 2"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">3</span>], <span class="at">y =</span> higherOrderScores[, <span class="st">"theta3"</span>],</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Higher Order Score for Theta 3"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> multidimensionalScores[, <span class="dv">4</span>], <span class="at">y =</span> higherOrderScores[, <span class="st">"theta4"</span>],</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">main =</span> <span class="st">"Multidimensional Score vs. Higher Order Score for Theta 4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="14_Subscores_and_Popular_Models_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-fit-comparison-2" class="level3">
<h3 class="anchored" data-anchor-id="model-fit-comparison-2">Model Fit Comparison</h3>
<div class="cell" data-hash="14_Subscores_and_Popular_Models_cache/html/unnamed-chunk-17_5f314e98aef7fa7538a7350f71272d0b">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(unidimensionalModel, multidimensionalModel, higherOrderModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Scaled Chi-Squared Difference Test (method = "satorra.2000")

lavaan NOTE:
    The "Chisq" column contains standard test statistics, not the
    robust test that should be reported per model. A robust difference
    test is a function of two standard (not robust) statistics.
 
                       Df AIC BIC  Chisq Chisq diff Df diff Pr(&gt;Chisq)    
multidimensionalModel 164         233.93                                  
higherOrderModel      166         252.42     13.261       2    0.00132 ** 
unidimensionalModel   170         419.00    141.738       4    &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>So, the higher order model is really what is needed…but, what if it does not fit? * We can use CFA-based tools (modification indices) to help make the model fit better</p>
</section>
</section>
<section id="historical-issues-with-bifactor-and-higher-order-models" class="level2">
<h2 class="anchored" data-anchor-id="historical-issues-with-bifactor-and-higher-order-models">Historical Issues with Bifactor and Higher Order Models</h2>
<p>Historically, bifactor and higher order models have been used to create subscores</p>
<ul>
<li>In some cases, the models are related</li>
</ul>
<p>Schmid and Leiman (1957) showed how, in an EFA context, a bifactor model could be transformed into a higher order model</p>
<ul>
<li>Assumed loadings of general to subfactors were proportional within a subfactor
<ul>
<li>Testable assumption</li>
<li>Not really valid for measurement purposes, however</li>
</ul></li>
</ul>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Today we investigated a classic educational measurement problem: The need for having both subscores and a total score</p>
<ul>
<li>We showed that the subscores and total score are incompatible models</li>
<li>We showed how several models were not valid for reporting both subscores and a total score</li>
<li>We showed how a higher order model was the best model for reporting both subscores and a total score</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>